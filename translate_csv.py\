import pandas as pd
from deep_translator import GoogleTranslator

# × ×ª×™×‘ ×”×§×•×‘×¥ ×”××§×•×¨×™
file_path = "/Users/eitanpelles/Desktop/telegram-bot/ads.csv"

# ×§×¨×™××ª ×”×§×•×‘×¥
df = pd.read_csv(file_path)

# ×‘×“×™×§×” ×× ×¢××•×“×ª "Product Desc" ×§×™×™××ª
if "Product Desc" in df.columns:
    # ×¤×•× ×§×¦×™×” ×œ×ª×¨×’×•× ×˜×§×¡×˜
    def translate_text(text):
        try:
            translated = GoogleTranslator(source='auto', target='iw').translate(text)
            print(f"ğŸ”¹ ×ª×•×¨×’×: {text} -> {translated}")  # ×”×“×¤×¡×ª ×”×ª×¨×’×•× ×œ×›×œ ××•×¦×¨
            return translated
        except Exception as e:
            print(f"×©×’×™××” ×‘×ª×¨×’×•×: {e}")
            return text  # ×‘××§×¨×” ×©×œ ×©×’×™××”, ×©×•××¨ ×¢×œ ×”×˜×§×¡×˜ ×”××§×•×¨×™

    # ×ª×¨×’×•× ×”×¢××•×“×” "Product Desc" ×‘×œ×‘×“
    df["Product Desc"] = df["Product Desc"].apply(lambda x: translate_text(x) if pd.notna(x) else x)

    # × ×ª×™×‘ ×œ×§×•×‘×¥ ×”×—×“×©
    translated_file_path = "/Users/eitanpelles/Desktop/telegram-bot/ads_translated.csv"

    # ×©××™×¨×ª ×”×§×•×‘×¥ ×”×—×“×©
    df.to_csv(translated_file_path, index=False)
    print(f"âœ… ×”×ª×¨×’×•× ×”×¡×ª×™×™×! ×§×•×‘×¥ × ×©××¨ ×‘: {translated_file_path}")

else:
    print("âŒ ×¢××•×“×ª 'Product Desc' ×œ× × ××¦××” ×‘×§×•×‘×¥!")
